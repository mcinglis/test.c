# Test.c

[![Travis CI build status](https://api.travis-ci.org/mcinglis/test.c.png)](https://travis-ci.org/mcinglis/test.c)

Test.c is a modern, simple testing library for C.

``` c
#include <test.c/test.h> // Test, TEST*, test*, Assertions, assertions_*

struct Assertions * numbers( void )
{
    return assertions(
        3 + 8 == 11,
        4 * 4 > 10,
        3 * 3 == 8 || 2 * 2 == 4
    );
}

struct Assertions * strings( void )
{
    return assertions(
        strcmp( "any", "boolean" ) < 0,
        strlen( "expression" ) != 3,
        "works"[ 2 ] == 'x'
    );
}

struct Assertions * xs_is_increasing( void )
{
    int const xs[] = { 3, 14, 98, 34, 291, 498, 89, -1 };
    struct Assertions * const as = assertions_empty();
    for ( size_t i = 0; xs[ i + 1 ] != -1; i += 1 ) {
        assertions_add( as, xs[ i ] <= xs[ i + 1 ],
                            i, xs[ i ], xs[ i + 1 ] );
    }
    return as;
}

int main( void ) {
    tests_run( "example", ( struct Test[] ) TEST_ARRAY(
        numbers,
        strings,
        xs_is_increasing
    ) );
    // Running example tests...
    //   pass:  numbers
    //   fail:  strings
    //     false:  "works"[ 2 ] == 'x'
    //   fail:  xs_is_increasing
    //     false:  xs[ i ] <= xs[ i + 1 ]
    //       (for i = 2, xs[ i ] = 98, xs[ i + 1 ] = 34)
    //       (for i = 5, xs[ i ] = 498, xs[ i + 1 ] = 89)
}
```

The `Test` and `Assertions` structs are typedef'd with the same name, so using `struct` with them is optional. I usually leave it off.

While Test.c provides conveniences for the most-common use-cases, it's based on a flexible and capable structure. See [`test.h`](/test.h), [`assertions.h`](/assertions.h), [`assertion.h`](/assertion.h), [`assertion-ids.h`](/assertion-ids.h) and [`assertion-id.h`](/assertion-id.h) for the complete documentation. There are [`examples/`](/examples/) which are compiled with `make`. Test.c's [`tests/`](/tests/) are written with Test.c, and you can read those for much more extensive demonstration, and to see its particular behaviors.

Files that include any "public" (not prefixed with `_`) header file need to be able to `#include <macromap.h/macromap.h>`, from [Macromap.h](https://github.com/mcinglis/macromap.h). [`Module.mk`](/Module.mk) is provided to make this easier. See the [projects using Test.c](#projects-using-testc) for examples of how to manage this.

[Questions](https://github.com/mcinglis/test.c/issues?labels=question), [discussion](https://github.com/mcinglis/test.c/issues?labels=discussion), [bug reports](https://github.com/mcinglis/test.c/issues?labels=bug), [feature requests](https://github.com/mcinglis/test.c/issues?labels=enhancement), and pull requests are very welcome.


## Releases

I try to [tag](http://git-scm.com/book/en/Git-Basics-Tagging) the releases according to [semantic versioning v2.0.0](http://semver.org/spec/v2.0.0.html); all the headers not prefixed with `_` are considered public; you're welcome to use everything in those headers, and depend on the comments. However, I don't consider adding identifiers to the public headers (or to the source files, with external linkage) as being an "incompatible change", even though there's a (tiny) chance that it may break your code.

You can browse the releases [on GitHub](https://github.com/mcinglis/test.c/releases), but because this project uses [submodules](http://git-scm.com/book/en/Git-Tools-Submodules), the archives generated by GitHub won't compile. You have to clone this repository to build it.


## Building

Test.c is written to the ISO C11 standard: it compiles with at least GCC 4.8, Clang 3.2, and Clang 3.3.

``` sh
# Initialize and update the submodules (you need to do this once after
# cloning, or pulling a commit which updates a submodule):
$ git submodule update --init --recursive

# Then, to run the default development build (with debugging symbols):
$ make
# To build with optimizations, and without debugging symbols and `assert()`s
$ make fast
# If you don't have a C11 compiler, it can compile under C99 (for now):
$ make CFLAGS='-std=c99'
```


## Projects using Test.c

- Test.c
- [Trie.c](https://github.com/mcinglis/trie.c)
- [Bytes.c](https://github.com/mcinglis/bytes.c)

Please let me know if you know of any others. It would be great to hear that other people find this useful.


## License

Copyright (C) 2013 Malcolm Inglis <http://minglis.id.au/>

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but **without any warranty**; without even the implied warranty of **merchantability** or **fitness for a particular purpose**. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program. If not, see <http://www.gnu.org/licenses/>.

Contact me if you'd like to use this program under different terms.

